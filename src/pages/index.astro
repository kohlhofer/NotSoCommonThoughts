---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import PostListItem from '../components/PostListItem.astro';

// Get all blog posts
const posts = await getCollection('blog');

// Get posts by category
const writingPosts = posts
  .filter(post => post.data.tags?.includes('long-form'))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 5);

const bitsPosts = posts
  .filter(post => post.data.tags?.includes('bits'))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 5);

const aiPosts = posts
  .filter(post => post.data.tags?.includes('ai'))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 5);
---

<Layout title="Not So Common Thoughts">
  <div class="max-w-2xl px-4 sm:px-6 lg:px-8">
    <!-- Writing Section -->
    <section class="mb-12 sm:mb-16">
      <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-4 mb-6">
        <h2 class="text-2xl font-semibold text-gray-900 dark:text-white">Writing</h2>
        <a href="/long-form" class="text-sm text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white">
          See all →
        </a>
      </div>
      <div class="space-y-6 sm:space-y-8">
        {writingPosts.map(post => (
          <PostListItem post={post} />
        ))}
      </div>
    </section>

    <!-- Bits Section -->
    <section class="mb-12 sm:mb-16">
      <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-4 mb-6">
        <h2 class="text-2xl font-semibold text-gray-900 dark:text-white">Bits</h2>
        <a href="/bits" class="text-sm text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white">
          See all →
        </a>
      </div>
      <div class="space-y-6 sm:space-y-8">
        {bitsPosts.map(post => (
          <PostListItem post={post} />
        ))}
      </div>
    </section>

    <!-- AI Section -->
    <section class="mb-12 sm:mb-16">
      <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-4 mb-6">
        <h2 class="text-2xl font-semibold text-gray-900 dark:text-white">AI</h2>
        <a href="/ai" class="text-sm text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white">
          See all →
        </a>
      </div>
      <div class="space-y-6 sm:space-y-8">
        {aiPosts.map(post => (
          <PostListItem post={post} />
        ))}
      </div>
    </section>
  </div>
</Layout>

<style>
  .bg-grid-white {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='rgb(255 255 255 / 0.04)'%3e%3cpath d='M0 .5H31.5V32'/%3e%3c/svg%3e");
  }
</style>
